import{getHost as a,getNormalizedPathname as e,isLocaleSupportedOnDomain as t,applyBasePath as n,formatTemplatePathname as o}from"./utils.js";function l(l){var r;let{config:c,localizedPathnames:p,request:s,resolvedLocale:f}=l;const h=s.nextUrl.clone(),i=a(s.headers);function m(a,e){return s.nextUrl.basePath&&((a=new URL(a)).pathname=n(a.pathname,s.nextUrl.basePath)),"<".concat(a.toString(),'>; rel="alternate"; hreflang="').concat(e,'"')}function u(a,e){return p&&"object"==typeof p?o(a,p[f],p[e]):a}i&&(h.port="",h.host=i),h.protocol=null!==(r=s.headers.get("x-forwarded-proto"))&&void 0!==r?r:h.protocol,h.pathname=e(h.pathname,c.locales);const d=c.locales.flatMap((a=>{function e(e){return"/"===e?"/".concat(a):"/".concat(a).concat(e)}let n;if(c.domains){return(c.domains.filter((e=>t(a,e)))||[]).map((t=>(n=new URL(h),n.port="",n.host=t.domain,n.pathname=u(h.pathname,a),a===t.defaultLocale&&"always"!==c.localePrefix||(n.pathname=e(n.pathname)),m(n,a))))}{let t;t=p&&"object"==typeof p?u(h.pathname,a):h.pathname,a===c.defaultLocale&&"always"!==c.localePrefix||(t=e(t)),n=new URL(t,h)}return m(n,a)}));if(!c.domains&&("always"!==c.localePrefix||"/"===h.pathname)){const a=new URL(u(h.pathname,c.defaultLocale),h);d.push(m(a,"x-default"))}return d.join(", ")}export{l as default};
